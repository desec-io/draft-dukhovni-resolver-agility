<?xml version="1.0" encoding="utf-8"?>
<!-- name="GENERATOR" content="github.com/mmarkdown/mmark Mmark Markdown Processor - mmark.miek.nl" -->
<rfc version="3" ipr="trust200902" docName="draft-dukhovni-resolver-agility-00" submissionType="IETF" category="std" xml:lang="en" xmlns:xi="http://www.w3.org/2001/XInclude" updates="4035" indexInclude="true" consensus="true">

<front>
<title abbrev="resolver-agility">Validating DNSSEC resolver algorithm agility clarifications</title><seriesInfo value="draft-dukhovni-resolver-agility-00" stream="IETF" status="standard" name="Internet-Draft"></seriesInfo>
<author initials="V." surname="Dukhovni" fullname="Viktor Dukhovni"><organization>Google LLC</organization><address><postal><street></street>
</postal><email>ietf-dane@dukhovni.org</email>
</address></author><author initials="P." surname="Thomassen" fullname="Peter Thomassen"><organization>deSEC, Secure Systems Engineering</organization><address><postal><street></street>
</postal><email>peter@desec.io</email>
</address></author><author initials="N." surname="Wisiol" fullname="Nils Wisiol"><organization>deSEC, Technische Universit√§t Berlin</organization><address><postal><street></street>
</postal><email>nils@desec.io</email>
</address></author><date year="2022" month="August" day="18"></date>
<area>Internet</area>
<workgroup>DNSOP Working Group</workgroup>

<abstract>
<t>DNSSEC (<xref target="RFC4035"></xref>) employs a number of zone signature algorithms.  When a zone
is signed with an algorithm that is also supported by a given validating
resolver, it MUST NOT be possible to hide this fact from the resolver and
thereby convince it to accept unvalidated answers, i.e. downgrade the zone from
&quot;Secure&quot; to &quot;Insecure&quot; (see section 4.3 of <xref target="RFC4035"></xref>).  How to avoid such
downgrades in resolvers is not adequately covered in <xref target="RFC4035"></xref>, this document
attempts to fill the gap.</t>
<t>[ Ed note: This document is being collaborated on at
<eref target="https://github.com/desec-io/draft-dukhovni-resolver-agility/">https://github.com/desec-io/draft-dukhovni-resolver-agility/</eref>.
The authors gratefully accept pull requests. ]</t>
</abstract>

</front>

<middle>

<section anchor="introduction"><name>Introduction</name>
<t>DNSSEC (<xref target="RFC4034"></xref>,<xref target="RFC4035"></xref>,<xref target="RFC5155"></xref>) employs a number of zone signing algorithms, some already
obsolete, some mainstream and mandatory to implement, and others recommended to
implement, but not yet widely deployed.  Validating resolvers generally support
a range of algorithms beyond the mandatory to implement set.  Some that are
deprecated, but still in use by a non-trivial number of deployed zones, others
that are expected to be in wider use in the future.  The status of the various
algorithms is noted in Section 3 of <xref target="RFC8624"></xref>, which is expected be updated
in subsequent documents from time to time.</t>
<t>Some zones may be signed with multiple algorithms.  Such multi-signed zones are
typically in a transitional state from one algorithm to another, with at least
the new algorithm expected to be widely deployed, allowing the older algorithm
to be dropped at the end of the transition period.</t>
<t>Therefore, when a zone is multi-signed, a resolver is expected to treat all
the mutually supported signature algorithms as equally valid, and to accept
valid signatures made via any of the supported algorithms.  This form of
<em>algorithm agility</em> is not expected to ensure that the <em>strongest</em> of multiple
shared algorithms is the only one used for validation, the sole requirement is
resistance to downgrades of zones signed via a supported algorithm to
&quot;Insecure&quot;.</t>
<t>One or more algorithms (signaled via the respective DS record set) with which
a zone is signed may not be supported by a
given validating resolver, and when none are supported, absent local policy
requiring the zone to be signed, the resolver MUST consider the zone &quot;Insecure&quot;
(see Section 4.3 of <xref target="RFC4035"></xref>).  When, as explained in <xref target="algorithm-agility"></xref>
below, the zone's signature algorithms overlap with those supported by the
resolver, the zone MUST NOT be treated &quot;Insecure&quot; (even when no RRSIGs for
supported algorithms are included in a given reply).</t>

<section anchor="requirements-notation"><name>Requirements Notation</name>
<t>The key words &quot;<bcp14>MUST</bcp14>&quot;, &quot;<bcp14>MUST NOT</bcp14>&quot;, &quot;<bcp14>REQUIRED</bcp14>&quot;,
&quot;<bcp14>SHALL</bcp14>&quot;, &quot;<bcp14>SHALL NOT</bcp14>&quot;, &quot;<bcp14>SHOULD</bcp14>&quot;, &quot;<bcp14>SHOULD NOT</bcp14>&quot;,
&quot;<bcp14>RECOMMENDED</bcp14>&quot;, &quot;<bcp14>NOT RECOMMENDED</bcp14>&quot;, &quot;<bcp14>MAY</bcp14>&quot;, and
&quot;<bcp14>OPTIONAL</bcp14>&quot; in this document are to be interpreted as described in
BCP 14 <xref target="RFC2119"></xref> <xref target="RFC8174"></xref> when, and only when, they appear in all
capitals, as shown here.</t>
</section>
</section>

<section anchor="algorithm-agility"><name>Algorithm agility</name>
<t>[[ Explain algorithm agility for DS records and that if a supported combination
   of signature and hash algorithms is found there, the resolver MUST check that
   the zone apex DNSKEY RRset has at least one valid signature made with a key
   (SEP) matching a supported DS record (or any local trust anchor), otherwise the
   entire zone is &quot;Bogus&quot; for lack of a &quot;Secure Entry Point&quot; (SEP).</t>
<t>The zone's candidate signing keys are then those zone apex DNSKEYs with
   protocol 3 (see section 2.1.2 of <xref target="RFC4034"></xref>)) and the &quot;Zone Key&quot; flag bit
   set (see section 2.1.1 of <xref target="RFC4034"></xref>).  The zone signer MUST ensure that
   each record in the zone has a signature made with each algorithm associated
   with some candidate zone signing key.</t>
<t>The requirements on the validating resolver are somewhat less strict, if the
   zone is not &quot;Insecure&quot;, for lack of a supported DS record in the parent zone
   (or a alternatively a local trust anchor), then the resolver MUST only require
   that at least one supported validatable RRSIG sign each RRset for which the zone
   is authoritative (i.e. everything other than delegation NS and glue address
   records).</t>
<t>This means that a resolver SHOULD accept a response signed with only a subset
   of the required signature algorithms, so long at least one of these signatures
   is supported and valid (passes signature validation, is not expired and made by
   a candidate key).</t>
<t>If a zone is not signed with all the required algorithms, it may appear &quot;Bogus&quot;
   to resolvers that only support the missing algorithms, so all the required
   signatures MUST be present, but resolvers SHOULD NOT enforce this.
   ... ]]</t>
</section>

<section anchor="security-considerations"><name>Security Considerations</name>
<t>This entire document discusses security considerations relating to avoiding
DNSSEC downgrades to &quot;Insecure&quot;.</t>
</section>

<section anchor="iana-considerations"><name>IANA Considerations</name>
<t>None</t>
</section>

<section anchor="acknowledgements"><name>Acknowledgements</name>
</section>

</middle>

<back>
<references><name>Normative References</name>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4034.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4035.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5155.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8624.xml"/>
</references>

<section anchor="change-history-to-be-removed-before-publication"><name>Change History (to be removed before publication)</name>

<ul spacing="compact">
<li>draft-dukhovni-resolver-agility-00</li>
</ul>
<blockquote><t>Initial public draft.</t>
</blockquote></section>

</back>

</rfc>
